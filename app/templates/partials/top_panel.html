<!-- app/templates/partials/top_panel.html -->
{% if agent_columns %}
<table class="agents-table">
  <thead>
    <tr>
      {% for col in agent_columns %}
      <th>{{ col }}</th>
      <!-- Русские псевдонимы столбцов -->
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for agent in agents %} 
    {% if request.url.query %}
    <tr
      hx-get="/ui/bottom-panel?agent_id={{ agent.id }}"
      hx-target="#bottom-right"
      hx-swap="innerHTML"
      hx-push-url="/agents?{{ request.url.query }}&agent_id={{ agent.id }}"
    >
      {% else %}
    </tr>

    <tr
      hx-get="/ui/bottom-panel?agent_id={{ agent.id }}"
      hx-target="#bottom-right"
      hx-swap="innerHTML"
      hx-push-url="/agents?agent_id={{ agent.id }}"
    >
      {% endif %}

      <td>
        {% if "linux" in agent.system.lower() %}
        <span class="icon-class icon-linux"></span>
        {% elif "mac" in agent.system.lower() or "apple" in agent.system.lower()
        %}
        <span class="icon-class icon-apple"></span>
        {% elif "windows" in agent.system.lower() %}
        <span class="icon-class icon-windows"></span>
        {% else %}
        <span>-</span>
        <!-- Показываем тире, если иконка не подошла -->
        {% endif %}
      </td>
      <td>{{ agent.name_pc }}</td>
      <td>{{ agent.user_name }}</td>
      <td>{{ agent.ip_addr }}</td>
      <td>{{ agent.company_name }}</td>
      <td>{{ agent.department_name }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<div>Выберите Company или Department, чтобы увидеть агентов</div>
{% endif %}
