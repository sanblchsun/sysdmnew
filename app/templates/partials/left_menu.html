<!-- app/templates/partials/left_menu.html -->
<span class="tree-controls">
  <button id="reset-splitters-btn" hx-on="click: resetSplitters()">
    –°–±—Ä–æ—Å–∏—Ç—å <br />—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏
  </button>
  <br />
  <button id="toggle-all-btn" hx-on="click: toggleAll()">–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë</button>
</span>
<br /><br />
{% macro render_node(node) %}
<li>
  {% if node.children %}
  <!-- ================= GROUP NODE ================= -->
  <div class="node">
    <!-- —Å—Ç—Ä–µ–ª–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è -->
    <span class="arrow" hx-on="click: toggleNode('{{ node.name_id }}', this)"
      >‚ñ∂</span
    >
    <!-- DROP ZONE -->
    <div
      class="label"
      data-node-type="{{ node.type }}"
      data-node-id="{{ node.id }}"
    >
      <!-- –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
      <a
        hx-get="/ui/top-panel"
        hx-target="#top-right"
        hx-swap="innerHTML"
        hx-trigger="click"
        hx-include="#target-id,#target-type"
        hx-push-url="/agents?target_type={{ node.type }}&target_id={{ node.id }}"
        hx-indicator="#loading-indicator"
        hx-on="
    click:
      document.getElementById('target-id').value='{{ node.id }}';
      document.getElementById('target-type').value='{{ node.type }}';
      document.getElementById('bottom-right').innerHTML =
        '<div class=&quot;empty-panel&quot;>–í—ã–±–µ—Ä–∏—Ç–µ –∞–≥–µ–Ω—Ç–∞</div>';
  "
      >
        {% if node.type == "company" %} üèõ {{ node.name }} {% elif node.type ==
        "unassigned" %} üì¶ {{ node.name }} {% elif node.type == "department" %}
        üìé {{ node.name }} {% else %} {{ node.name }} {% endif %}
      </a>
    </div>
  </div>
  <!-- –î–ï–¢–ò -->
  <ul class="collapsible" data-id="{{ node.name_id }}">
    {% for child in node.children %} {{ render_node(child) }} {% endfor %}
  </ul>
  {% else %}
  <!-- ================= AGENT LEAF ================= -->
  <div class="node agent-leaf">
    <span class="agent-indent"></span>
    <span class="label agent-label"> üë§ {{ node.name }} </span>
  </div>
  {% endif %}
</li>
{% endmacro %}
<ul id="tree-root" class="tree-root">
  {% for company in companies %} {{ render_node(company) }} {% endfor %}
</ul>
