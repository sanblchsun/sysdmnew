<!-- app/templates/partials/left_menu.html -->
<nav>
  <h2>Company Tree</h2>

  <button id="toggle-all-btn" onclick="toggleAll()">–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë</button>

  {% macro render_node(node) %}
  <li>
    {% if node.children %}
    <div class="node">
      <span class="arrow" onclick="toggleNode('{{ node.id }}', this)">‚ñ∂</span>

      <a
        class="label"
        hx-get="/ui/top-panel?company_id={{ node.id }}"
        hx-trigger="click"
        hx-target="#top-right"
        hx-indicator="#loading-indicator"
      >
        {{ node.name }}
      </a>
    </div>

    <ul class="collapsible" data-id="{{ node.id }}">
      {% for child in node.children %} {{ render_node(child) }} {% endfor %}
    </ul>
    {% else %}
    <div class="node">
      <span style="width: 1em"></span>
      <span class="label">
        {% if node.type == "agent" %} üë§ {{ node.name }} {% else %} {{ node.name
        }} {% endif %}
      </span>
    </div>
    {% endif %}
  </li>
  {% endmacro %}

  <ul id="tree-root">
    {% for company in companies %} {{ render_node(company) }} {% endfor %}
  </ul>
</nav>
